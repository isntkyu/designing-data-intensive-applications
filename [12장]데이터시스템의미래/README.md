## 12장 데이터시스템의 미래

### 데이터 통합

다양한 상황과 솔루션의 장단점, 트레이드오프를 고려하고,  
모든 상황에 적합한 소프트웨어는 없으니 여러 sw를 엮어 사용한다.

#### 파생 데이터에 특화된 도구의 결합

본인의 경험에 의존한 판단보다 줌아웃해서 넓은 데이터 플로우를 고려한다.

#### 데이터 플로에 대한 추론

파생 데이터 시스템은 이벤트 로그를 기반으로 갱신하면 멱등성을 지녀 결함에서 복구하기 용이하다.

#### 파생 데이터 vs 분산 트랜잭션

트랜잭션 시스템은 선형성을 지원하여, 자신이 쓴 내용 읽기 같은 유용함을 보장  
파생 데이터 시스템은 비동기로 갱신되기 떄문에 기본적으로 동시간 갱신보장을 하지 않음.

#### 전체 순서화의 제약

전체 순서 브로드캐스트(==합의) 단일 리더 노드에서는 가능(그래서 인기 많음)  
지역적 데이터 센터 분산 ,MSA 등 합의 알고리즘은 연구 과제다.

#### 람다아키텍처

과거 데이터는 일괄처리(배치)하면서 스트림연산도 구현.

---

### 데이터베이스 언번들링

#### 데이터저장소 기술 구성하기

#### 색인 생성하기

#### 모든 것의 메타데이터베이스

#### 언번들리잉 동작하게 만들기

#### 언번들링 대 통합 시스템

#### 데이터 플로 주변 애플리케이션 설계

#### 파생 함수로서의 애플리케이션 코드

#### 애플리케이션 코드와 상태의 분리

#### 데이터플로: 상태 변경과 애플리케이션 코드 간 상호작용

#### 스트림 처리자와 서비스

#### 파생 상태 관찰하기

#### 구체화 뷰와 캐싱

#### 오프라인 대응 가능한 상태 저장 클라이언트

#### 상태 변경을 클라이언트에게 푸시하기

#### 종단 간 이벤트 스트림

#### 읽기도 이벤트다

#### 다중 파티션 데이터 처리

---

### 정확성을 목표로

#### 데이터베이스에 관한 종단 간 논증

#### 연산자의 정확히 한 번 실행

첫 시도가 성공했을지 아닐지 모르는 상태에서 재시도하게 되는 것은 데이터 손상이다.  
연산을 멱등하게 만들면 안전하다.

#### 중복 억제

TCP 연결에 문제가 생기면 트랜잭션이 어떻게 처리됐는지 알 수 없다.

#### 연산 식별자

unique key를 통한 중복억제.(uuid등을 사용하여)

#### 종단 간 논증

#### 종단 간 사고를 데이터 시스템에 적용하기

#### 제약 조건 강제하기

#### 유일성 제약 조건은 합의가 필요하다

단일 노드를 리더로 사용하면 제약 조건을 만족하지만, 장애를 대응한다고 하면 합의를 해야한다.

#### 로그 기반 메시징의 유일성

전체 순서 브로드캐스트: 모든 소비자가 동일한 순서로 메시지를 보도록 보장한다.

#### 다중 파티션 요청 처리

#### 적시성과 무결성

일관성 = 적시성 + 무결성 / 적시성은 유저가 항상 최신상태로 시스템을 관측한다. 무결성은 데이터 손상이 없다.

#### 데이터 플로 시스템의 정확성

ACID 트랜잭션은 적시성과 무결성을 보장한다.  
이벤트 스트림의 경우 비동기라서 적시성은 보장되지 않는다.
즉, 스트림의 핵심은 무결성이다.  
정확히 한 번이나 결과적으로 한 번 시맨틱은 무결성을 보존하는 메커니즘이다.

#### 느슨하게 해석되는 제약 조건

제약을 느슨히 하고 보상트랜잭션

#### 코디네이션 회피 데이터 시스템

합의 없이 무결성 보장 가능한 시스템이다. 일시적으로 제약이 위반되어도 후에 고친다.  
동기식 합의(코디네이션)보다 성능과 내결함성이 좋다. 대신 적시성이 약하다.  
최상의 트레이드오프를 찾자.

#### 믿어라. 하지만 확인하라.

#### 소프트웨어 버그가 발생해도 무결성 유지하기

#### 약속을 맹목적으로 믿지 마라

#### 검증하는 문화

#### 감사기능 설계

트랜잭션보다는 이벤트 기반 시스템이 더 나은 감사 기능을 제공한다.  
결정적이고 잘 정의한 데이터플로를 사용하면 디버깅과 추적이 쉬워진다.

#### 다시 종단 간 논증

#### 감사 데이터 시스템용 도구

### 옳은 일 하기

#용어집